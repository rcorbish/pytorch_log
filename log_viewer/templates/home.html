{% extends 'base.html' %}

{% block header %}
  {% block title %}Runs{% endblock %}
{% endblock %}

{% block content %}
  {% for model in models %}
    <article class="post">
      <header>
        <div>
          <h1>{{ model['model_name'] }} / {{ model['data_name'] }}</h1>

          <ul>
          {% for run in model.runs() %}
          <li><a href="run/{{ model['model_name'] }}/{{ model['data_name'] }}/{{ run['time'] }}/">{{ run['time'] }}</a>
            <button class="del-button"
              data-href="run/{{ model['model_name'] }}/{{ model['data_name'] }}/{{ run['time'] }}/"
              data-run-time="{{ run['time'] }}"
            > &#x1f5d1; 
            </button>
          </li>
          {% endfor %}    
        </ul>
        </div>
      </header>
    </article>
    {% if not loop.last %}
      <hr>
    {% endif %}
  {% endfor %}

  <script>
      window.addEventListener( "load", function(e) {
          var xhr = new XMLHttpRequest() 
          xhr.addEventListener("load", function(e) {
            location.reload() 
          }) 

          var btns = document.querySelectorAll( ".del-button" ) 
          for( var i=0 ; i<btns.length ; i++ ) {

            btns[i].addEventListener( "click", function(e) {
                if( confirm( "Delete this run\n" + this.dataset.runTime ) ) {
                  xhr.open("DELETE", this.dataset.href )
                  xhr.send()
                }
              }.bind( btns[i] ) 
            ) 

          } // end for
      })
    </script>    
    
{% endblock %} 

